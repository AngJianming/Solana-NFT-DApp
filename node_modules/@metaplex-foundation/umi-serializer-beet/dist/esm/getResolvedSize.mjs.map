{"version":3,"file":"getResolvedSize.mjs","sources":["../../src/getResolvedSize.ts"],"sourcesContent":["import { ArrayLikeSerializerSize } from '@metaplex-foundation/umi';\nimport { BeetSerializerError } from './errors';\nimport { sumSerializerSizes } from './sumSerializerSizes';\n\nexport function getResolvedSize(\n  size: ArrayLikeSerializerSize,\n  childrenSizes: (number | null)[],\n  bytes: Uint8Array,\n  offset: number\n): [number | bigint, number] {\n  if (typeof size === 'number') {\n    return [size, offset];\n  }\n\n  if (typeof size === 'object') {\n    return size.deserialize(bytes, offset);\n  }\n\n  if (size === 'remainder') {\n    const childrenSize = sumSerializerSizes(childrenSizes);\n    if (childrenSize === null) {\n      throw new BeetSerializerError(\n        'Serializers of \"remainder\" size must have fixed-size items.'\n      );\n    }\n    const remainder = bytes.slice(offset).length;\n    if (remainder % childrenSize !== 0) {\n      throw new BeetSerializerError(\n        `Serializers of \"remainder\" size must have a remainder that is a multiple of its item size. ` +\n          `Got ${remainder} bytes remaining and ${childrenSize} bytes per item.`\n      );\n    }\n    return [remainder / childrenSize, offset];\n  }\n\n  throw new BeetSerializerError(`Unknown size type: ${JSON.stringify(size)}.`);\n}\n"],"names":["getResolvedSize","size","childrenSizes","bytes","offset","deserialize","childrenSize","sumSerializerSizes","BeetSerializerError","remainder","slice","length","JSON","stringify"],"mappings":";;;AAIO,SAASA,eAAe,CAC7BC,IAA6B,EAC7BC,aAAgC,EAChCC,KAAiB,EACjBC,MAAc,EACa;AAC3B,EAAA,IAAI,OAAOH,IAAI,KAAK,QAAQ,EAAE;AAC5B,IAAA,OAAO,CAACA,IAAI,EAAEG,MAAM,CAAC,CAAA;AACvB,GAAA;AAEA,EAAA,IAAI,OAAOH,IAAI,KAAK,QAAQ,EAAE;AAC5B,IAAA,OAAOA,IAAI,CAACI,WAAW,CAACF,KAAK,EAAEC,MAAM,CAAC,CAAA;AACxC,GAAA;EAEA,IAAIH,IAAI,KAAK,WAAW,EAAE;AACxB,IAAA,MAAMK,YAAY,GAAGC,kBAAkB,CAACL,aAAa,CAAC,CAAA;IACtD,IAAII,YAAY,KAAK,IAAI,EAAE;AACzB,MAAA,MAAM,IAAIE,mBAAmB,CAC3B,6DAA6D,CAC9D,CAAA;AACH,KAAA;IACA,MAAMC,SAAS,GAAGN,KAAK,CAACO,KAAK,CAACN,MAAM,CAAC,CAACO,MAAM,CAAA;AAC5C,IAAA,IAAIF,SAAS,GAAGH,YAAY,KAAK,CAAC,EAAE;MAClC,MAAM,IAAIE,mBAAmB,CAC1B,CAA4F,2FAAA,CAAA,GAC1F,OAAMC,SAAU,CAAA,qBAAA,EAAuBH,YAAa,CAAA,gBAAA,CAAiB,CACzE,CAAA;AACH,KAAA;AACA,IAAA,OAAO,CAACG,SAAS,GAAGH,YAAY,EAAEF,MAAM,CAAC,CAAA;AAC3C,GAAA;EAEA,MAAM,IAAII,mBAAmB,CAAE,CAAqBI,mBAAAA,EAAAA,IAAI,CAACC,SAAS,CAACZ,IAAI,CAAE,CAAA,CAAA,CAAE,CAAC,CAAA;AAC9E;;;;"}