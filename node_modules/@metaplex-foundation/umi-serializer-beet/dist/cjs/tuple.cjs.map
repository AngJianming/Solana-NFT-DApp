{"version":3,"file":"tuple.cjs","sources":["../../src/tuple.ts"],"sourcesContent":["import {\n  Serializer,\n  TupleSerializerOptions,\n  WrapInSerializer,\n  mergeBytes,\n} from '@metaplex-foundation/umi';\nimport { BeetSerializerError } from './errors';\nimport { sumSerializerSizes } from './sumSerializerSizes';\n\nexport function tuple<T extends any[], U extends T = T>(\n  items: WrapInSerializer<[...T], [...U]>,\n  options: TupleSerializerOptions = {}\n): Serializer<T, U> {\n  const itemDescriptions = items.map((item) => item.description).join(', ');\n  return {\n    description: options.description ?? `tuple(${itemDescriptions})`,\n    fixedSize: sumSerializerSizes(items.map((item) => item.fixedSize)),\n    maxSize: sumSerializerSizes(items.map((item) => item.maxSize)),\n    serialize: (value: T) => {\n      if (value.length !== items.length) {\n        throw new BeetSerializerError(\n          `Expected tuple to have ${items.length} items but got ${value.length}.`\n        );\n      }\n      return mergeBytes(\n        items.map((item, index) => item.serialize(value[index]))\n      );\n    },\n    deserialize: (bytes: Uint8Array, offset = 0) => {\n      const values = [] as any as U;\n      items.forEach((serializer) => {\n        const [newValue, newOffset] = serializer.deserialize(bytes, offset);\n        values.push(newValue);\n        offset = newOffset;\n      });\n      return [values, offset];\n    },\n  };\n}\n"],"names":["tuple","items","options","itemDescriptions","map","item","description","join","fixedSize","sumSerializerSizes","maxSize","serialize","value","length","BeetSerializerError","mergeBytes","index","deserialize","bytes","offset","values","forEach","serializer","newValue","newOffset","push"],"mappings":";;;;;;;;AASO,SAASA,KAAK,CACnBC,KAAuC,EACvCC,OAA+B,GAAG,EAAE,EAClB;AAClB,EAAA,MAAMC,gBAAgB,GAAGF,KAAK,CAACG,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAACC,WAAW,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAA;EACzE,OAAO;AACLD,IAAAA,WAAW,EAAEJ,OAAO,CAACI,WAAW,IAAK,CAAA,MAAA,EAAQH,gBAAiB,CAAE,CAAA,CAAA;AAChEK,IAAAA,SAAS,EAAEC,qCAAkB,CAACR,KAAK,CAACG,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAACG,SAAS,CAAC,CAAC;AAClEE,IAAAA,OAAO,EAAED,qCAAkB,CAACR,KAAK,CAACG,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAACK,OAAO,CAAC,CAAC;IAC9DC,SAAS,EAAGC,KAAQ,IAAK;AACvB,MAAA,IAAIA,KAAK,CAACC,MAAM,KAAKZ,KAAK,CAACY,MAAM,EAAE;AACjC,QAAA,MAAM,IAAIC,0BAAmB,CAC1B,CAAA,uBAAA,EAAyBb,KAAK,CAACY,MAAO,CAAA,eAAA,EAAiBD,KAAK,CAACC,MAAO,CAAA,CAAA,CAAE,CACxE,CAAA;AACH,OAAA;MACA,OAAOE,cAAU,CACfd,KAAK,CAACG,GAAG,CAAC,CAACC,IAAI,EAAEW,KAAK,KAAKX,IAAI,CAACM,SAAS,CAACC,KAAK,CAACI,KAAK,CAAC,CAAC,CAAC,CACzD,CAAA;KACF;AACDC,IAAAA,WAAW,EAAE,CAACC,KAAiB,EAAEC,MAAM,GAAG,CAAC,KAAK;MAC9C,MAAMC,MAAM,GAAG,EAAc,CAAA;AAC7BnB,MAAAA,KAAK,CAACoB,OAAO,CAAEC,UAAU,IAAK;AAC5B,QAAA,MAAM,CAACC,QAAQ,EAAEC,SAAS,CAAC,GAAGF,UAAU,CAACL,WAAW,CAACC,KAAK,EAAEC,MAAM,CAAC,CAAA;AACnEC,QAAAA,MAAM,CAACK,IAAI,CAACF,QAAQ,CAAC,CAAA;AACrBJ,QAAAA,MAAM,GAAGK,SAAS,CAAA;AACpB,OAAC,CAAC,CAAA;AACF,MAAA,OAAO,CAACJ,MAAM,EAAED,MAAM,CAAC,CAAA;AACzB,KAAA;GACD,CAAA;AACH;;;;"}